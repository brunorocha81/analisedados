wants <- c('jsonlite', 'digest', 'readr', 'careless', 'car','dplyr')
has <- wants %in% rownames(installed.packages())
if (any(!has)) install.packages(wants[!has])

library(readr)      # biblioteca para leitura de arquivos CVS
library(digest)     # biblioteca para anonimizar dados
library(careless)   # biblioteca para tratamento de respostas descuidadas
library(car)        # biblioteca para graficar Boxplots com identificaÃ§Ã£o de pontos
library(dplyr)      # biblioteca para manipular data.frames

## Leitura do questionario DFS usando arquivo CSV
fss_dat <- read_csv("data/survey-fss.csv")
resp_fss_dat <- select(fss_dat, starts_with("Q"))

## Tratamento de respostas descuidadas (careless response)
(careless_fss_long <- longstring(resp_fss_dat)) 
Boxplot(careless_fss_long, main = "Boxplot do Longstring para o FSS") # 11,27,42,13 respostas a ser eliminada

careless_fss_irv <- irv(resp_fss_dat)
careless_fss_irv_idx <- order(careless_fss_irv)

careless_irv_df <- cbind(resp = careless_fss_irv_idx
                         , IRV=careless_fss_irv[careless_fss_irv_idx]
                         , resp_fss_dat[careless_fss_irv_idx,])
head(careless_irv_df)

## Anonimizar usuarios e salvar respostas descuidadas e DFS sem respostas descuidadas 


write_csv(fss_dat[c(11,27,42,13,14),], 'data/fss-careless.csv')
write_csv(fss_dat[-c(11,27,42,13,14),], 'data/fss.csv')
